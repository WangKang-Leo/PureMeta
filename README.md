
<!-- README.md is generated from README.Rmd. Please edit that file -->

# PureMeta <img src='image/PureMeta_logo.jpg' align="right" height="139" /></a>

<!-- badges: start -->
<!-- badges: end -->

## Overview

The goal of **PureMeta** is to provide functionality for extracting
tumor cells-based gene expression profiles from bulk RNA-seq or
microarray data, and generating tumor metabolic phenotype
(i.e.Â downregulated, neutral, upregulated) for seven metabolic pathways.

## Installation

You can install the development version of PureMeta from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("WangKang-Leo/PureMeta")
```

## Example

**This is a basic example which shows you how to run PureMeta:**

**Step1**: Extracting tumor cell GEP from bulk RNA-seq/microarray data,
where you also need tumor adjacent tissue GEP as control. The bulk tumor
and normal GEP come from the sample experiments (no significant batch
effect existed). Make sure GEP data is in normal (not log) space. This
example used 30 tumor and 5 non-cancerous breast tissue (normal) GEP
from
[GSE87455](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE87455).

``` r
library(PureMeta)
## Only run 10 samples, this example would take ~10min
TC_GEP=Extract_TC_GEP(tumor[,1:10],normal) 
#> INFO [2024-01-18 13:46:24] Initializing model...
#> INFO [2024-01-18 13:46:24] MIN_KAPPA set to 106575.525430137
#> INFO [2024-01-18 13:46:24] Running ISOpure step 1: CPE - Cancer Profile Estimation Step
#> INFO [2024-01-18 13:46:24] --- optimizing mm...
#> INFO [2024-01-18 13:46:33] --- optimizing theta...
#> INFO [2024-01-18 13:46:49] --- optimizing vv...
#> INFO [2024-01-18 13:46:49] --- optimizing kappa...
#> INFO [2024-01-18 13:46:49] --- optimizing omega...
#> INFO [2024-01-18 13:46:50] Total log likelihood: -687124539.858204
#> INFO [2024-01-18 13:46:50] iter: 1/35, loglikelihood: -687124539.858204,
#> INFO [2024-01-18 13:46:50]        change: Inf
#> INFO [2024-01-18 13:46:50] --- optimizing mm...
#> INFO [2024-01-18 13:47:00] --- optimizing theta...
#> INFO [2024-01-18 13:47:20] --- optimizing vv...
#> INFO [2024-01-18 13:47:20] --- optimizing kappa...
#> INFO [2024-01-18 13:47:20] --- optimizing omega...
#> INFO [2024-01-18 13:47:21] Total log likelihood: -686998635.083014
#> INFO [2024-01-18 13:47:21] iter: 2/35, loglikelihood: -686998635.083014,
#> INFO [2024-01-18 13:47:21]        change: 0.000183267868028444
#> INFO [2024-01-18 13:47:21] --- optimizing mm...
#> INFO [2024-01-18 13:47:31] --- optimizing theta...
#> INFO [2024-01-18 13:47:45] --- optimizing vv...
#> INFO [2024-01-18 13:47:45] --- optimizing kappa...
#> INFO [2024-01-18 13:47:45] --- optimizing omega...
#> INFO [2024-01-18 13:47:45] Total log likelihood: -686990425.989862
#> INFO [2024-01-18 13:47:45] iter: 3/35, loglikelihood: -686990425.989862,
#> INFO [2024-01-18 13:47:45]        change: 1.1949355975173e-05
#> INFO [2024-01-18 13:47:45] --- optimizing mm...
#> INFO [2024-01-18 13:47:55] --- optimizing theta...
#> INFO [2024-01-18 13:48:11] --- optimizing vv...
#> INFO [2024-01-18 13:48:11] --- optimizing kappa...
#> INFO [2024-01-18 13:48:12] --- optimizing omega...
#> INFO [2024-01-18 13:48:12] Total log likelihood: -686988533.198415
#> INFO [2024-01-18 13:48:12] iter: 4/35, loglikelihood: -686988533.198415,
#> INFO [2024-01-18 13:48:12]        change: 2.75520093197471e-06
#> INFO [2024-01-18 13:48:12] --- optimizing mm...
#> INFO [2024-01-18 13:48:19] --- optimizing theta...
#> INFO [2024-01-18 13:48:33] --- optimizing vv...
#> INFO [2024-01-18 13:48:33] --- optimizing kappa...
#> INFO [2024-01-18 13:48:33] --- optimizing omega...
#> INFO [2024-01-18 13:48:33] Total log likelihood: -686987736.873637
#> INFO [2024-01-18 13:48:33] iter: 5/35, loglikelihood: -686987736.873637,
#> INFO [2024-01-18 13:48:33]        change: 1.1591542835753e-06
#> INFO [2024-01-18 13:48:33] --- optimizing mm...
#> INFO [2024-01-18 13:48:42] --- optimizing theta...
#> INFO [2024-01-18 13:48:56] --- optimizing vv...
#> INFO [2024-01-18 13:48:56] --- optimizing kappa...
#> INFO [2024-01-18 13:48:56] --- optimizing omega...
#> INFO [2024-01-18 13:48:57] Total log likelihood: -686987265.21407
#> INFO [2024-01-18 13:48:57] iter: 6/35, loglikelihood: -686987265.21407,
#> INFO [2024-01-18 13:48:57]        change: 6.86562315255054e-07
#> INFO [2024-01-18 13:48:57] --- optimizing mm...
#> INFO [2024-01-18 13:49:06] --- optimizing theta...
#> INFO [2024-01-18 13:49:22] --- optimizing vv...
#> INFO [2024-01-18 13:49:22] --- optimizing kappa...
#> INFO [2024-01-18 13:49:22] --- optimizing omega...
#> INFO [2024-01-18 13:49:23] Total log likelihood: -686986938.733353
#> INFO [2024-01-18 13:49:23] iter: 7/35, loglikelihood: -686986938.733353,
#> INFO [2024-01-18 13:49:23]        change: 4.75235697241184e-07
#> INFO [2024-01-18 13:49:23] --- optimizing mm...
#> INFO [2024-01-18 13:49:32] --- optimizing theta...
#> INFO [2024-01-18 13:49:48] --- optimizing vv...
#> INFO [2024-01-18 13:49:48] --- optimizing kappa...
#> INFO [2024-01-18 13:49:48] --- optimizing omega...
#> INFO [2024-01-18 13:49:49] Total log likelihood: -686986722.640423
#> INFO [2024-01-18 13:49:49] iter: 8/35, loglikelihood: -686986722.640423,
#> INFO [2024-01-18 13:49:49]        change: 3.14551829655155e-07
#> INFO [2024-01-18 13:49:49] --- optimizing mm...
#> INFO [2024-01-18 13:49:58] --- optimizing theta...
#> INFO [2024-01-18 13:50:17] --- optimizing vv...
#> INFO [2024-01-18 13:50:17] --- optimizing kappa...
#> INFO [2024-01-18 13:50:17] --- optimizing omega...
#> INFO [2024-01-18 13:50:18] Total log likelihood: -686986531.453054
#> INFO [2024-01-18 13:50:18] iter: 9/35, loglikelihood: -686986531.453054,
#> INFO [2024-01-18 13:50:18]        change: 2.78298569355354e-07
#> INFO [2024-01-18 13:50:18] --- optimizing mm...
#> INFO [2024-01-18 13:50:28] --- optimizing theta...
#> INFO [2024-01-18 13:50:43] --- optimizing vv...
#> INFO [2024-01-18 13:50:43] --- optimizing kappa...
#> INFO [2024-01-18 13:50:43] --- optimizing omega...
#> INFO [2024-01-18 13:50:43] Total log likelihood: -686986382.823416
#> INFO [2024-01-18 13:50:43] iter: 10/35, loglikelihood: -686986382.823416,
#> INFO [2024-01-18 13:50:43]        change: 2.16350195449568e-07
#> INFO [2024-01-18 13:50:43] --- optimizing mm...
#> INFO [2024-01-18 13:50:51] --- optimizing theta...
#> INFO [2024-01-18 13:51:05] --- optimizing vv...
#> INFO [2024-01-18 13:51:05] --- optimizing kappa...
#> INFO [2024-01-18 13:51:05] --- optimizing omega...
#> INFO [2024-01-18 13:51:06] Total log likelihood: -686986265.010308
#> INFO [2024-01-18 13:51:06] iter: 11/35, loglikelihood: -686986265.010308,
#> INFO [2024-01-18 13:51:06]        change: 1.7149266768871e-07
#> INFO [2024-01-18 13:51:06] --- optimizing mm...
#> INFO [2024-01-18 13:51:12] --- optimizing theta...
#> INFO [2024-01-18 13:51:26] --- optimizing vv...
#> INFO [2024-01-18 13:51:26] --- optimizing kappa...
#> INFO [2024-01-18 13:51:26] --- optimizing omega...
#> INFO [2024-01-18 13:51:26] Total log likelihood: -686986156.983832
#> INFO [2024-01-18 13:51:26] iter: 12/35, loglikelihood: -686986156.983832,
#> INFO [2024-01-18 13:51:26]        change: 1.57246948171286e-07
#> INFO [2024-01-18 13:51:26] --- optimizing mm...
#> INFO [2024-01-18 13:51:33] --- optimizing theta...
#> INFO [2024-01-18 13:51:46] --- optimizing vv...
#> INFO [2024-01-18 13:51:46] --- optimizing kappa...
#> INFO [2024-01-18 13:51:47] --- optimizing omega...
#> INFO [2024-01-18 13:51:47] Total log likelihood: -686986056.791051
#> INFO [2024-01-18 13:51:47] iter: 13/35, loglikelihood: -686986056.791051,
#> INFO [2024-01-18 13:51:47]        change: 1.45843979835493e-07
#> INFO [2024-01-18 13:51:47] --- optimizing mm...
#> INFO [2024-01-18 13:51:57] --- optimizing theta...
#> INFO [2024-01-18 13:52:13] --- optimizing vv...
#> INFO [2024-01-18 13:52:13] --- optimizing kappa...
#> INFO [2024-01-18 13:52:13] --- optimizing omega...
#> INFO [2024-01-18 13:52:14] Total log likelihood: -686985962.517338
#> INFO [2024-01-18 13:52:14] iter: 14/35, loglikelihood: -686985962.517338,
#> INFO [2024-01-18 13:52:14]        change: 1.37228004671318e-07
#> INFO [2024-01-18 13:52:14] --- optimizing mm...
#> INFO [2024-01-18 13:52:21] --- optimizing theta...
#> INFO [2024-01-18 13:52:37] --- optimizing vv...
#> INFO [2024-01-18 13:52:37] --- optimizing kappa...
#> INFO [2024-01-18 13:52:38] --- optimizing omega...
#> INFO [2024-01-18 13:52:38] Total log likelihood: -686985873.95017
#> INFO [2024-01-18 13:52:38] iter: 15/35, loglikelihood: -686985873.95017,
#> INFO [2024-01-18 13:52:38]        change: 1.28921381756088e-07
#> INFO [2024-01-18 13:52:38] --- optimizing mm...
#> INFO [2024-01-18 13:52:48] --- optimizing theta...
#> INFO [2024-01-18 13:53:05] --- optimizing vv...
#> INFO [2024-01-18 13:53:05] --- optimizing kappa...
#> INFO [2024-01-18 13:53:05] --- optimizing omega...
#> INFO [2024-01-18 13:53:05] Total log likelihood: -686985786.311105
#> INFO [2024-01-18 13:53:05] iter: 16/35, loglikelihood: -686985786.311105,
#> INFO [2024-01-18 13:53:05]        change: 1.27570419438547e-07
#> INFO [2024-01-18 13:53:05] --- optimizing mm...
#> INFO [2024-01-18 13:53:13] --- optimizing theta...
#> INFO [2024-01-18 13:53:33] --- optimizing vv...
#> INFO [2024-01-18 13:53:33] --- optimizing kappa...
#> INFO [2024-01-18 13:53:33] --- optimizing omega...
#> INFO [2024-01-18 13:53:34] Total log likelihood: -686985702.738418
#> INFO [2024-01-18 13:53:34] iter: 17/35, loglikelihood: -686985702.738418,
#> INFO [2024-01-18 13:53:34]        change: 1.21651275039755e-07
#> INFO [2024-01-18 13:53:34] --- optimizing mm...
#> INFO [2024-01-18 13:53:42] --- optimizing theta...
#> INFO [2024-01-18 13:54:00] --- optimizing vv...
#> INFO [2024-01-18 13:54:00] --- optimizing kappa...
#> INFO [2024-01-18 13:54:01] --- optimizing omega...
#> INFO [2024-01-18 13:54:02] Total log likelihood: -686985616.911278
#> INFO [2024-01-18 13:54:02] iter: 18/35, loglikelihood: -686985616.911278,
#> INFO [2024-01-18 13:54:02]        change: 1.24932951398283e-07
#> INFO [2024-01-18 13:54:02] --- optimizing mm...
#> INFO [2024-01-18 13:54:10] --- optimizing theta...
#> INFO [2024-01-18 13:54:27] --- optimizing vv...
#> INFO [2024-01-18 13:54:27] --- optimizing kappa...
#> INFO [2024-01-18 13:54:28] --- optimizing omega...
#> INFO [2024-01-18 13:54:28] Total log likelihood: -686985536.727654
#> INFO [2024-01-18 13:54:28] iter: 19/35, loglikelihood: -686985536.727654,
#> INFO [2024-01-18 13:54:28]        change: 1.16718066314838e-07
#> INFO [2024-01-18 13:54:28] --- optimizing mm...
#> INFO [2024-01-18 13:54:37] --- optimizing theta...
#> INFO [2024-01-18 13:54:58] --- optimizing vv...
#> INFO [2024-01-18 13:54:58] --- optimizing kappa...
#> INFO [2024-01-18 13:54:58] --- optimizing omega...
#> INFO [2024-01-18 13:54:59] Total log likelihood: -686985455.894108
#> INFO [2024-01-18 13:54:59] iter: 20/35, loglikelihood: -686985455.894108,
#> INFO [2024-01-18 13:54:59]        change: 1.17664130075706e-07
#> INFO [2024-01-18 13:54:59] --- optimizing mm...
#> INFO [2024-01-18 13:55:07] --- optimizing theta...
#> INFO [2024-01-18 13:55:27] --- optimizing vv...
#> INFO [2024-01-18 13:55:27] --- optimizing kappa...
#> INFO [2024-01-18 13:55:27] --- optimizing omega...
#> INFO [2024-01-18 13:55:28] Total log likelihood: -686985377.636191
#> INFO [2024-01-18 13:55:28] iter: 21/35, loglikelihood: -686985377.636191,
#> INFO [2024-01-18 13:55:28]        change: 1.13914967269611e-07
#> INFO [2024-01-18 13:55:28] --- optimizing mm...
#> INFO [2024-01-18 13:55:37] --- optimizing theta...
#> INFO [2024-01-18 13:55:53] --- optimizing vv...
#> INFO [2024-01-18 13:55:53] --- optimizing kappa...
#> INFO [2024-01-18 13:55:53] --- optimizing omega...
#> INFO [2024-01-18 13:55:54] Total log likelihood: -686985306.843524
#> INFO [2024-01-18 13:55:54] iter: 22/35, loglikelihood: -686985306.843524,
#> INFO [2024-01-18 13:55:54]        change: 1.03048298943941e-07
#> INFO [2024-01-18 13:55:54] --- optimizing mm...
#> INFO [2024-01-18 13:56:03] --- optimizing theta...
#> INFO [2024-01-18 13:56:22] --- optimizing vv...
#> INFO [2024-01-18 13:56:22] --- optimizing kappa...
#> INFO [2024-01-18 13:56:22] --- optimizing omega...
#> INFO [2024-01-18 13:56:23] Total log likelihood: -686985239.650364
#> INFO [2024-01-18 13:56:23] iter: 23/35, loglikelihood: -686985239.650364,
#> INFO [2024-01-18 13:56:23]        change: 9.78087399480545e-08
#> INFO [2024-01-18 13:56:23] --- optimizing mm...
#> INFO [2024-01-18 13:56:31] --- optimizing theta...
#> INFO [2024-01-18 13:56:51] --- optimizing vv...
#> INFO [2024-01-18 13:56:51] --- optimizing kappa...
#> INFO [2024-01-18 13:56:51] --- optimizing omega...
#> INFO [2024-01-18 13:56:52] Total log likelihood: -686985156.757993
#> INFO [2024-01-18 13:56:52] iter: 24/35, loglikelihood: -686985156.757993,
#> INFO [2024-01-18 13:56:52]        change: 1.20661080145673e-07
#> INFO [2024-01-18 13:56:52] --- optimizing mm...
#> INFO [2024-01-18 13:57:02] --- optimizing theta...
#> INFO [2024-01-18 13:57:22] --- optimizing vv...
#> INFO [2024-01-18 13:57:22] --- optimizing kappa...
#> INFO [2024-01-18 13:57:22] --- optimizing omega...
#> INFO [2024-01-18 13:57:23] Total log likelihood: -686985081.617714
#> INFO [2024-01-18 13:57:23] iter: 25/35, loglikelihood: -686985081.617714,
#> INFO [2024-01-18 13:57:23]        change: 1.09376870719892e-07
#> INFO [2024-01-18 13:57:23] --- optimizing mm...
#> INFO [2024-01-18 13:57:32] --- optimizing theta...
#> INFO [2024-01-18 13:57:50] --- optimizing vv...
#> INFO [2024-01-18 13:57:50] --- optimizing kappa...
#> INFO [2024-01-18 13:57:50] --- optimizing omega...
#> INFO [2024-01-18 13:57:50] Total log likelihood: -686984987.227799
#> INFO [2024-01-18 13:57:50] iter: 26/35, loglikelihood: -686984987.227799,
#> INFO [2024-01-18 13:57:50]        change: 1.37397347979892e-07
#> INFO [2024-01-18 13:57:50] --- optimizing mm...
#> INFO [2024-01-18 13:58:01] --- optimizing theta...
#> INFO [2024-01-18 13:58:23] --- optimizing vv...
#> INFO [2024-01-18 13:58:23] --- optimizing kappa...
#> INFO [2024-01-18 13:58:23] --- optimizing omega...
#> INFO [2024-01-18 13:58:24] Total log likelihood: -686984906.392363
#> INFO [2024-01-18 13:58:24] iter: 27/35, loglikelihood: -686984906.392363,
#> INFO [2024-01-18 13:58:24]        change: 1.17666974395365e-07
#> INFO [2024-01-18 13:58:24] --- optimizing mm...
#> INFO [2024-01-18 13:58:35] --- optimizing theta...
#> INFO [2024-01-18 13:58:56] --- optimizing vv...
#> INFO [2024-01-18 13:58:56] --- optimizing kappa...
#> INFO [2024-01-18 13:58:57] --- optimizing omega...
#> INFO [2024-01-18 13:58:57] Total log likelihood: -686984803.458876
#> INFO [2024-01-18 13:58:57] iter: 28/35, loglikelihood: -686984803.458876,
#> INFO [2024-01-18 13:58:57]        change: 1.4983371745666e-07
#> INFO [2024-01-18 13:58:57] --- optimizing mm...
#> INFO [2024-01-18 13:59:07] --- optimizing theta...
#> INFO [2024-01-18 13:59:25] --- optimizing vv...
#> INFO [2024-01-18 13:59:25] --- optimizing kappa...
#> INFO [2024-01-18 13:59:26] --- optimizing omega...
#> INFO [2024-01-18 13:59:26] Total log likelihood: -686984710.051423
#> INFO [2024-01-18 13:59:26] iter: 29/35, loglikelihood: -686984710.051423,
#> INFO [2024-01-18 13:59:26]        change: 1.3596729634522e-07
#> INFO [2024-01-18 13:59:26] --- optimizing mm...
#> INFO [2024-01-18 13:59:35] --- optimizing theta...
#> INFO [2024-01-18 13:59:52] --- optimizing vv...
#> INFO [2024-01-18 13:59:52] --- optimizing kappa...
#> INFO [2024-01-18 13:59:52] --- optimizing omega...
#> INFO [2024-01-18 13:59:52] Total log likelihood: -686984611.731125
#> INFO [2024-01-18 13:59:52] iter: 30/35, loglikelihood: -686984611.731125,
#> INFO [2024-01-18 13:59:52]        change: 1.43118631134189e-07
#> INFO [2024-01-18 13:59:52] --- optimizing mm...
#> INFO [2024-01-18 14:00:02] --- optimizing theta...
#> INFO [2024-01-18 14:00:22] --- optimizing vv...
#> INFO [2024-01-18 14:00:22] --- optimizing kappa...
#> INFO [2024-01-18 14:00:22] --- optimizing omega...
#> INFO [2024-01-18 14:00:23] Total log likelihood: -686984528.460079
#> INFO [2024-01-18 14:00:23] iter: 31/35, loglikelihood: -686984528.460079,
#> INFO [2024-01-18 14:00:23]        change: 1.21212403762716e-07
#> INFO [2024-01-18 14:00:23] --- optimizing mm...
#> INFO [2024-01-18 14:00:34] --- optimizing theta...
#> INFO [2024-01-18 14:00:57] --- optimizing vv...
#> INFO [2024-01-18 14:00:57] --- optimizing kappa...
#> INFO [2024-01-18 14:00:57] --- optimizing omega...
#> INFO [2024-01-18 14:00:58] Total log likelihood: -686984434.229831
#> INFO [2024-01-18 14:00:58] iter: 32/35, loglikelihood: -686984434.229831,
#> INFO [2024-01-18 14:00:58]        change: 1.3716504222357e-07
#> INFO [2024-01-18 14:00:58] --- optimizing mm...
#> INFO [2024-01-18 14:01:07] --- optimizing theta...
#> INFO [2024-01-18 14:01:26] --- optimizing vv...
#> INFO [2024-01-18 14:01:26] --- optimizing kappa...
#> INFO [2024-01-18 14:01:26] --- optimizing omega...
#> INFO [2024-01-18 14:01:27] Total log likelihood: -686984353.695388
#> INFO [2024-01-18 14:01:27] iter: 33/35, loglikelihood: -686984353.695388,
#> INFO [2024-01-18 14:01:27]        change: 1.17228931974855e-07
#> INFO [2024-01-18 14:01:27] --- optimizing mm...
#> INFO [2024-01-18 14:01:35] --- optimizing theta...
#> INFO [2024-01-18 14:01:53] --- optimizing vv...
#> INFO [2024-01-18 14:01:53] --- optimizing kappa...
#> INFO [2024-01-18 14:01:54] --- optimizing omega...
#> INFO [2024-01-18 14:01:54] Total log likelihood: -686984274.038666
#> INFO [2024-01-18 14:01:54] iter: 34/35, loglikelihood: -686984274.038666,
#> INFO [2024-01-18 14:01:54]        change: 1.15951304035136e-07
#> INFO [2024-01-18 14:01:54] --- optimizing mm...
#> INFO [2024-01-18 14:02:02] --- optimizing theta...
#> INFO [2024-01-18 14:02:19] --- optimizing vv...
#> INFO [2024-01-18 14:02:19] --- optimizing kappa...
#> INFO [2024-01-18 14:02:19] --- optimizing omega...
#> INFO [2024-01-18 14:02:20] Total log likelihood: -686984206.571783
#> INFO [2024-01-18 14:02:20] iter: 35/35, loglikelihood: -686984206.571783,
#> INFO [2024-01-18 14:02:20]        change: 9.82073276473012e-08
#> INFO [2024-01-18 14:02:20] Initializing model ...
#> INFO [2024-01-18 14:02:20] MIN_KAPPA set to 486738.752603441
#> INFO [2024-01-18 14:02:20] Running ISOpure step 2: PPE - Patient Profile Estimation Step
#> INFO [2024-01-18 14:02:20] --- optimizing cc...
#> INFO [2024-01-18 14:02:40] --- optimizing theta...
#> INFO [2024-01-18 14:03:08] --- optimizing vv...
#> INFO [2024-01-18 14:03:08] --- optimizing kappa...
#> INFO [2024-01-18 14:03:13] Total log likelihood: -683389392.876072
#> INFO [2024-01-18 14:03:13] iter: 1/35, loglikelihood: -683389392.876072,
#> INFO [2024-01-18 14:03:13]        change: Inf
#> INFO [2024-01-18 14:03:13] --- optimizing cc...
#> INFO [2024-01-18 14:03:31] --- optimizing theta...
#> INFO [2024-01-18 14:03:51] --- optimizing vv...
#> INFO [2024-01-18 14:03:51] --- optimizing kappa...
#> INFO [2024-01-18 14:03:55] Total log likelihood: -682589590.393983
#> INFO [2024-01-18 14:03:55] iter: 2/35, loglikelihood: -682589590.393983,
#> INFO [2024-01-18 14:03:55]        change: 0.00117171795958249
#> INFO [2024-01-18 14:03:55] --- optimizing cc...
#> INFO [2024-01-18 14:04:09] --- optimizing theta...
#> INFO [2024-01-18 14:04:26] --- optimizing vv...
#> INFO [2024-01-18 14:04:26] --- optimizing kappa...
#> INFO [2024-01-18 14:04:29] Total log likelihood: -682529320.278496
#> INFO [2024-01-18 14:04:29] iter: 3/35, loglikelihood: -682529320.278496,
#> INFO [2024-01-18 14:04:29]        change: 8.8304067966468e-05
#> INFO [2024-01-18 14:04:29] --- optimizing cc...
#> INFO [2024-01-18 14:04:44] --- optimizing theta...
#> INFO [2024-01-18 14:05:04] --- optimizing vv...
#> INFO [2024-01-18 14:05:04] --- optimizing kappa...
#> INFO [2024-01-18 14:05:08] Total log likelihood: -682524505.121962
#> INFO [2024-01-18 14:05:08] iter: 4/35, loglikelihood: -682524505.121962,
#> INFO [2024-01-18 14:05:08]        change: 7.05492110150573e-06
#> INFO [2024-01-18 14:05:08] --- optimizing cc...
#> INFO [2024-01-18 14:05:21] --- optimizing theta...
#> INFO [2024-01-18 14:05:39] --- optimizing vv...
#> INFO [2024-01-18 14:05:39] --- optimizing kappa...
#> INFO [2024-01-18 14:05:42] Total log likelihood: -682523413.865329
#> INFO [2024-01-18 14:05:42] iter: 5/35, loglikelihood: -682523413.865329,
#> INFO [2024-01-18 14:05:42]        change: 1.59885596846803e-06
#> INFO [2024-01-18 14:05:42] --- optimizing cc...
#> INFO [2024-01-18 14:05:55] --- optimizing theta...
#> INFO [2024-01-18 14:06:13] --- optimizing vv...
#> INFO [2024-01-18 14:06:13] --- optimizing kappa...
#> INFO [2024-01-18 14:06:16] Total log likelihood: -682523002.525841
#> INFO [2024-01-18 14:06:16] iter: 6/35, loglikelihood: -682523002.525841,
#> INFO [2024-01-18 14:06:16]        change: 6.02674907179324e-07
#> INFO [2024-01-18 14:06:16] --- optimizing cc...
#> INFO [2024-01-18 14:06:30] --- optimizing theta...
#> INFO [2024-01-18 14:06:53] --- optimizing vv...
#> INFO [2024-01-18 14:06:53] --- optimizing kappa...
#> INFO [2024-01-18 14:06:57] Total log likelihood: -682522819.31827
#> INFO [2024-01-18 14:06:57] iter: 7/35, loglikelihood: -682522819.31827,
#> INFO [2024-01-18 14:06:57]        change: 2.68427027027575e-07
#> INFO [2024-01-18 14:06:57] --- optimizing cc...
#> INFO [2024-01-18 14:07:11] --- optimizing theta...
#> INFO [2024-01-18 14:07:29] --- optimizing vv...
#> INFO [2024-01-18 14:07:29] --- optimizing kappa...
#> INFO [2024-01-18 14:07:33] Total log likelihood: -682522704.135989
#> INFO [2024-01-18 14:07:33] iter: 8/35, loglikelihood: -682522704.135989,
#> INFO [2024-01-18 14:07:33]        change: 1.68759633629992e-07
#> INFO [2024-01-18 14:07:33] --- optimizing cc...
#> INFO [2024-01-18 14:07:47] --- optimizing theta...
#> INFO [2024-01-18 14:08:04] --- optimizing vv...
#> INFO [2024-01-18 14:08:04] --- optimizing kappa...
#> INFO [2024-01-18 14:08:07] Total log likelihood: -682522633.680057
#> INFO [2024-01-18 14:08:07] iter: 9/35, loglikelihood: -682522633.680057,
#> INFO [2024-01-18 14:08:07]        change: 1.03228711116634e-07
#> INFO [2024-01-18 14:08:07] --- optimizing cc...
#> INFO [2024-01-18 14:08:19] --- optimizing theta...
#> INFO [2024-01-18 14:08:31] --- optimizing vv...
#> INFO [2024-01-18 14:08:31] --- optimizing kappa...
#> INFO [2024-01-18 14:08:33] Total log likelihood: -682522585.855405
#> INFO [2024-01-18 14:08:33] iter: 10/35, loglikelihood: -682522585.855405,
#> INFO [2024-01-18 14:08:33]        change: 7.00704305920989e-08
#> INFO [2024-01-18 14:08:33] --- optimizing cc...
#> INFO [2024-01-18 14:08:42] --- optimizing theta...
#> INFO [2024-01-18 14:08:54] --- optimizing vv...
#> INFO [2024-01-18 14:08:54] --- optimizing kappa...
#> INFO [2024-01-18 14:08:56] Total log likelihood: -682522551.958207
#> INFO [2024-01-18 14:08:56] iter: 11/35, loglikelihood: -682522551.958207,
#> INFO [2024-01-18 14:08:56]        change: 4.96645832196504e-08
#> INFO [2024-01-18 14:08:56] --- optimizing cc...
#> INFO [2024-01-18 14:09:05] --- optimizing theta...
#> INFO [2024-01-18 14:09:15] --- optimizing vv...
#> INFO [2024-01-18 14:09:15] --- optimizing kappa...
#> INFO [2024-01-18 14:09:17] Total log likelihood: -682522526.554284
#> INFO [2024-01-18 14:09:17] iter: 12/35, loglikelihood: -682522526.554284,
#> INFO [2024-01-18 14:09:17]        change: 3.72206369248045e-08
#> INFO [2024-01-18 14:09:17] --- optimizing cc...
#> INFO [2024-01-18 14:09:25] --- optimizing theta...
#> INFO [2024-01-18 14:09:37] --- optimizing vv...
#> INFO [2024-01-18 14:09:37] --- optimizing kappa...
#> INFO [2024-01-18 14:09:39] Total log likelihood: -682522505.70782
#> INFO [2024-01-18 14:09:39] iter: 13/35, loglikelihood: -682522505.70782,
#> INFO [2024-01-18 14:09:39]        change: 3.05432621270964e-08
#> INFO [2024-01-18 14:09:39] --- optimizing cc...
#> INFO [2024-01-18 14:09:48] --- optimizing theta...
#> INFO [2024-01-18 14:09:59] --- optimizing vv...
#> INFO [2024-01-18 14:09:59] --- optimizing kappa...
#> INFO [2024-01-18 14:10:01] Total log likelihood: -682522490.36376
#> INFO [2024-01-18 14:10:01] iter: 14/35, loglikelihood: -682522490.36376,
#> INFO [2024-01-18 14:10:01]        change: 2.24813986340488e-08
#> INFO [2024-01-18 14:10:01] --- optimizing cc...
#> INFO [2024-01-18 14:10:10] --- optimizing theta...
#> INFO [2024-01-18 14:10:20] --- optimizing vv...
#> INFO [2024-01-18 14:10:20] --- optimizing kappa...
#> INFO [2024-01-18 14:10:22] Total log likelihood: -682522477.882035
#> INFO [2024-01-18 14:10:22] iter: 15/35, loglikelihood: -682522477.882035,
#> INFO [2024-01-18 14:10:22]        change: 1.82876390793857e-08
#> INFO [2024-01-18 14:10:22] --- optimizing cc...
#> INFO [2024-01-18 14:10:31] --- optimizing theta...
#> INFO [2024-01-18 14:10:42] --- optimizing vv...
#> INFO [2024-01-18 14:10:42] --- optimizing kappa...
#> INFO [2024-01-18 14:10:44] Total log likelihood: -682522467.823941
#> INFO [2024-01-18 14:10:44] iter: 16/35, loglikelihood: -682522467.823941,
#> INFO [2024-01-18 14:10:44]        change: 1.47366493225411e-08
#> INFO [2024-01-18 14:10:44] --- optimizing cc...
#> INFO [2024-01-18 14:10:53] --- optimizing theta...
#> INFO [2024-01-18 14:11:04] --- optimizing vv...
#> INFO [2024-01-18 14:11:04] --- optimizing kappa...
#> INFO [2024-01-18 14:11:06] Total log likelihood: -682522458.159431
#> INFO [2024-01-18 14:11:06] iter: 17/35, loglikelihood: -682522458.159431,
#> INFO [2024-01-18 14:11:06]        change: 1.41599888088127e-08
#> INFO [2024-01-18 14:11:06] --- optimizing cc...
#> INFO [2024-01-18 14:11:15] --- optimizing theta...
#> INFO [2024-01-18 14:11:26] --- optimizing vv...
#> INFO [2024-01-18 14:11:26] --- optimizing kappa...
#> INFO [2024-01-18 14:11:28] Total log likelihood: -682522449.887644
#> INFO [2024-01-18 14:11:28] iter: 18/35, loglikelihood: -682522449.887644,
#> INFO [2024-01-18 14:11:28]        change: 1.21194353257098e-08
#> INFO [2024-01-18 14:11:28] --- optimizing cc...
#> INFO [2024-01-18 14:11:36] --- optimizing theta...
#> INFO [2024-01-18 14:11:48] --- optimizing vv...
#> INFO [2024-01-18 14:11:48] --- optimizing kappa...
#> INFO [2024-01-18 14:11:50] Total log likelihood: -682522443.004969
#> INFO [2024-01-18 14:11:50] iter: 19/35, loglikelihood: -682522443.004969,
#> INFO [2024-01-18 14:11:50]        change: 1.00841736177465e-08
#> INFO [2024-01-18 14:11:50] --- optimizing cc...
#> INFO [2024-01-18 14:11:59] --- optimizing theta...
#> INFO [2024-01-18 14:12:09] --- optimizing vv...
#> INFO [2024-01-18 14:12:09] --- optimizing kappa...
#> INFO [2024-01-18 14:12:11] Total log likelihood: -682522435.058016
#> INFO [2024-01-18 14:12:11] iter: 20/35, loglikelihood: -682522435.058016,
#> INFO [2024-01-18 14:12:11]        change: 1.16435045209427e-08
#> INFO [2024-01-18 14:12:11] --- optimizing cc...
#> INFO [2024-01-18 14:12:21] --- optimizing theta...
#> INFO [2024-01-18 14:12:33] --- optimizing vv...
#> INFO [2024-01-18 14:12:33] --- optimizing kappa...
#> INFO [2024-01-18 14:12:35] Total log likelihood: -682522427.048452
#> INFO [2024-01-18 14:12:35] iter: 21/35, loglikelihood: -682522427.048452,
#> INFO [2024-01-18 14:12:35]        change: 1.17352391737795e-08
#> INFO [2024-01-18 14:12:35] --- optimizing cc...
#> INFO [2024-01-18 14:12:45] --- optimizing theta...
#> INFO [2024-01-18 14:12:57] --- optimizing vv...
#> INFO [2024-01-18 14:12:57] --- optimizing kappa...
#> INFO [2024-01-18 14:13:00] Total log likelihood: -682522421.347576
#> INFO [2024-01-18 14:13:00] iter: 22/35, loglikelihood: -682522421.347576,
#> INFO [2024-01-18 14:13:00]        change: 8.35265729011247e-09
#> INFO [2024-01-18 14:13:00] --- optimizing cc...
#> INFO [2024-01-18 14:13:11] --- optimizing theta...
#> INFO [2024-01-18 14:13:25] --- optimizing vv...
#> INFO [2024-01-18 14:13:25] --- optimizing kappa...
#> INFO [2024-01-18 14:13:27] Total log likelihood: -682522416.40129
#> INFO [2024-01-18 14:13:27] iter: 23/35, loglikelihood: -682522416.40129,
#> INFO [2024-01-18 14:13:27]        change: 7.2470684617134e-09
#> INFO [2024-01-18 14:13:27] --- optimizing cc...
#> INFO [2024-01-18 14:13:37] --- optimizing theta...
#> INFO [2024-01-18 14:13:47] --- optimizing vv...
#> INFO [2024-01-18 14:13:47] --- optimizing kappa...
#> INFO [2024-01-18 14:13:49] Total log likelihood: -682522411.299764
#> INFO [2024-01-18 14:13:49] iter: 24/35, loglikelihood: -682522411.299764,
#> INFO [2024-01-18 14:13:49]        change: 7.47451778621159e-09
#> INFO [2024-01-18 14:13:49] --- optimizing cc...
#> INFO [2024-01-18 14:13:58] --- optimizing theta...
#> INFO [2024-01-18 14:14:09] --- optimizing vv...
#> INFO [2024-01-18 14:14:09] --- optimizing kappa...
#> INFO [2024-01-18 14:14:11] Total log likelihood: -682522406.797692
#> INFO [2024-01-18 14:14:11] iter: 25/35, loglikelihood: -682522406.797692,
#> INFO [2024-01-18 14:14:11]        change: 6.59622624875191e-09
#> INFO [2024-01-18 14:14:11] --- optimizing cc...
#> INFO [2024-01-18 14:14:20] --- optimizing theta...
#> INFO [2024-01-18 14:14:31] --- optimizing vv...
#> INFO [2024-01-18 14:14:31] --- optimizing kappa...
#> INFO [2024-01-18 14:14:32] Total log likelihood: -682522402.636833
#> INFO [2024-01-18 14:14:32] iter: 26/35, loglikelihood: -682522402.636833,
#> INFO [2024-01-18 14:14:32]        change: 6.0962962303778e-09
#> INFO [2024-01-18 14:14:32] --- optimizing cc...
#> INFO [2024-01-18 14:14:41] --- optimizing theta...
#> INFO [2024-01-18 14:14:52] --- optimizing vv...
#> INFO [2024-01-18 14:14:52] --- optimizing kappa...
#> INFO [2024-01-18 14:14:54] Total log likelihood: -682522398.395139
#> INFO [2024-01-18 14:14:54] iter: 27/35, loglikelihood: -682522398.395139,
#> INFO [2024-01-18 14:14:54]        change: 6.21473279286206e-09
#> INFO [2024-01-18 14:14:54] --- optimizing cc...
#> INFO [2024-01-18 14:15:03] --- optimizing theta...
#> INFO [2024-01-18 14:15:14] --- optimizing vv...
#> INFO [2024-01-18 14:15:14] --- optimizing kappa...
#> INFO [2024-01-18 14:15:16] Total log likelihood: -682522394.35154
#> INFO [2024-01-18 14:15:16] iter: 28/35, loglikelihood: -682522394.35154,
#> INFO [2024-01-18 14:15:16]        change: 5.92449227358728e-09
#> INFO [2024-01-18 14:15:16] --- optimizing cc...
#> INFO [2024-01-18 14:15:25] --- optimizing theta...
#> INFO [2024-01-18 14:15:36] --- optimizing vv...
#> INFO [2024-01-18 14:15:36] --- optimizing kappa...
#> INFO [2024-01-18 14:15:38] Total log likelihood: -682522390.568449
#> INFO [2024-01-18 14:15:38] iter: 29/35, loglikelihood: -682522390.568449,
#> INFO [2024-01-18 14:15:38]        change: 5.54280890964809e-09
#> INFO [2024-01-18 14:15:38] --- optimizing cc...
#> INFO [2024-01-18 14:15:46] --- optimizing theta...
#> INFO [2024-01-18 14:15:59] --- optimizing vv...
#> INFO [2024-01-18 14:15:59] --- optimizing kappa...
#> INFO [2024-01-18 14:16:01] Total log likelihood: -682522386.861756
#> INFO [2024-01-18 14:16:01] iter: 30/35, loglikelihood: -682522386.861756,
#> INFO [2024-01-18 14:16:01]        change: 5.43087360382474e-09
#> INFO [2024-01-18 14:16:01] --- optimizing cc...
#> INFO [2024-01-18 14:16:10] --- optimizing theta...
#> INFO [2024-01-18 14:16:21] --- optimizing vv...
#> INFO [2024-01-18 14:16:21] --- optimizing kappa...
#> INFO [2024-01-18 14:16:23] Total log likelihood: -682522383.105939
#> INFO [2024-01-18 14:16:23] iter: 31/35, loglikelihood: -682522383.105939,
#> INFO [2024-01-18 14:16:23]        change: 5.50284800829741e-09
#> INFO [2024-01-18 14:16:23] --- optimizing cc...
#> INFO [2024-01-18 14:16:32] --- optimizing theta...
#> INFO [2024-01-18 14:16:42] --- optimizing vv...
#> INFO [2024-01-18 14:16:42] --- optimizing kappa...
#> INFO [2024-01-18 14:16:44] Total log likelihood: -682522379.068379
#> INFO [2024-01-18 14:16:44] iter: 32/35, loglikelihood: -682522379.068379,
#> INFO [2024-01-18 14:16:44]        change: 5.9156446597639e-09
#> INFO [2024-01-18 14:16:44] --- optimizing cc...
#> INFO [2024-01-18 14:16:53] --- optimizing theta...
#> INFO [2024-01-18 14:17:03] --- optimizing vv...
#> INFO [2024-01-18 14:17:03] --- optimizing kappa...
#> INFO [2024-01-18 14:17:05] Total log likelihood: -682522375.297826
#> INFO [2024-01-18 14:17:05] iter: 33/35, loglikelihood: -682522375.297826,
#> INFO [2024-01-18 14:17:05]        change: 5.52443917872039e-09
#> INFO [2024-01-18 14:17:05] --- optimizing cc...
#> INFO [2024-01-18 14:17:14] --- optimizing theta...
#> INFO [2024-01-18 14:17:26] --- optimizing vv...
#> INFO [2024-01-18 14:17:26] --- optimizing kappa...
#> INFO [2024-01-18 14:17:29] Total log likelihood: -682522371.298953
#> INFO [2024-01-18 14:17:29] iter: 34/35, loglikelihood: -682522371.298953,
#> INFO [2024-01-18 14:17:29]        change: 5.85896252421158e-09
#> INFO [2024-01-18 14:17:29] --- optimizing cc...
#> INFO [2024-01-18 14:17:38] --- optimizing theta...
#> INFO [2024-01-18 14:17:53] --- optimizing vv...
#> INFO [2024-01-18 14:17:53] --- optimizing kappa...
#> INFO [2024-01-18 14:17:56] Total log likelihood: -682522367.698196
#> INFO [2024-01-18 14:17:56] iter: 35/35, loglikelihood: -682522367.698196,
#> INFO [2024-01-18 14:17:56]        change: 5.27566083751494e-09
```

**The results included inferred tumor purity(0-1) as well as tumor cell
GEP.**

**To show distribution of purity.**

``` r
library(ggpubr)
ggdensity(TC_GEP$purity,fill = "lightyellow",add = "mean", rug = TRUE)
```

<img src="image/exampple-unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;" />

**Step2**: Generating metabolic phenotype using tumor cell GEP derived
from step1, or using tumor bulk GEP.

**For bulk GEP**

``` r
# run MetaPhenotype for 10 samples, p cut-off value was set as 0.1
Bulk_phenotype=MetaPhenotype(tumor[,1:10],0.1)
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 1 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 2 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 3 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 4 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 5 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 6 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 7 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 8 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 9 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 10 samples"
```

**Calculate and show proportion of metabolic phenotype for seven
pathway**

``` r
library(ggpubr);library(tidyverse)
phenotype=Bulk_phenotype$Metabolite_phenotype
data=phenotype[,2:8]
proportion_matrix <-data%>%
  pivot_longer(cols = everything()) %>%
  group_by(name, value) %>%
  summarize(percentage = n() / nrow(data)) %>%
  pivot_wider(names_from = value, values_from = percentage, values_fill = 0)
meta_name=proportion_matrix$name
proportion_matrix$name=NULL
proportion_matrix=t(proportion_matrix)
colnames(proportion_matrix)=meta_name
barplot(proportion_matrix, legend.text=T,
        names.arg=c("Amino_acid","Lipid","Carbohydrate","TCA_cycle","Energy","Nucleotide","Vitamin"),
        col =c("#99CCFF","#FF6666","#CCCCCC"))
```

<img src="image/exampple-unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;" />

**For Tumor cell GEP**

``` r
TC_phenotype=MetaPhenotype(TC_GEP$tumor_cell_GEP,0.1)
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 1 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 2 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 3 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 4 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 5 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 6 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 7 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 8 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 9 samples"
#> preparing geneSet collections...
#> GSEA analysis...
#> leading edge analysis...
#> done...
#> [1] "Finish 10 samples"
```

**Calculate and show proportion of metabolic phenotype for seven
pathway**

``` r
library(ggpubr);library(tidyverse)
phenotype=TC_phenotype$Metabolite_phenotype
data=phenotype[,2:8]
proportion_matrix <-data%>%
  pivot_longer(cols = everything()) %>%
  group_by(name, value) %>%
  summarize(percentage = n() / nrow(data)) %>%
  pivot_wider(names_from = value, values_from = percentage, values_fill = 0)
meta_name=proportion_matrix$name
proportion_matrix$name=NULL
proportion_matrix=t(proportion_matrix)
colnames(proportion_matrix)=meta_name
barplot(proportion_matrix, legend.text=T,
        names.arg=c("Amino_acid","Lipid","Carbohydrate","TCA_cycle","Energy","Nucleotide","Vitamin"),
        col =c("#99CCFF","#FF6666","#CCCCCC"))
```

<img src="image/exampple-unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;" />

## Citation

If PureMeta software is used in your publication, please cite the
following paper(s):

- Longitudinal molecular profiling elucidates immunometabolism dynamics
  in breast cancer. [Kang Wang et al.]() . (application of PureMeta to
  the longitudinal breast cancer cohort).
